!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.pip||(e.pip={})).controls=t()}}(function(){return function t(e,o,i){function n(r,a){if(!o[r]){if(!e[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var p=new Error("Cannot find module '"+r+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[r]={exports:{}};e[r][0].call(c.exports,function(t){var o=e[r][1][t];return n(o?o:t)},c,c.exports,t,e,o,i)}return o[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)n(i[r]);return n}({1:[function(t,e,o){"use strict";var i=function(){function t(t,e,o,i){var n=["purple","lightgreen","green","darkred","pink","yellow","cyan"];this._$timeout=i,this._$scope=t,this.class=o.class||"",this.colors=!t.colors||_.isArray(t.colors)&&0===t.colors.length?n:t.colors,this.colorChange=t.colorChange||null,this.currentColor=t.currentColor||this.colors[0],this.currentColorIndex=this.colors.indexOf(this.currentColor),this.ngDisabled=t.ngDisabled}return t.$inject=["$scope","$element","$attrs","$timeout"],t.prototype.disabled=function(){return!this.ngDisabled||this.ngDisabled()},t.prototype.selectColor=function(t){var e=this;this.disabled()||(this.currentColorIndex=t,this.currentColor=this.colors[this.currentColorIndex],this._$timeout(function(){e._$scope.$apply()}),this.colorChange&&this.colorChange())},t.prototype.enterSpacePress=function(t){this.selectColor(t.index)},t}();o.ColorPickerController=i,function(){function t(t){"ngInject";return{restrict:"EA",scope:{ngDisabled:"&",colors:"=pipColors",currentColor:"=ngModel",colorChange:"&ngChange"},templateUrl:"color_picker/color_picker.html",controller:i,controllerAs:"vm"}}t.$inject=["$parse"],angular.module("pipColorPicker",["pipControls.Templates"]).directive("pipColorPicker",t)}()},{}],2:[function(t,e,o){!function(){"use strict";angular.module("pipControls",["pipMarkdown","pipColorPicker","pipRoutingProgress","pipPopover","pipImageSlider","pipToasts","pipControls.Translate"])}()},{}],3:[function(t,e,o){!function(){"use strict";var t=angular.module("pipControls.Translate",[]);t.filter("translate",["$injector",function(t){var e=t.has("pipTranslate")?t.get("pipTranslate"):null;return function(t){return e?e.translate(t)||t:t}}])}()},{}],4:[function(t,e,o){var i=function(){function t(t,e,o,i,n,s,r){var a=this;this._index=0,this.DEFAULT_INTERVAL=4500,this.swipeStart=0,this.sliderIndex=t.sliderIndex,this._type=t.type(),this._interval=t.interval(),console.log("$scope.interval()",t.interval()),this._$attrs=o,this._$interval=s,t.slideTo=this.slideToPrivate,e.addClass("pip-image-slider"),e.addClass("pip-animation-"+this._type),this.setIndex(),n(function(){a._blocks=e.find(".pip-animation-block"),a._blocks.length>0&&$(a._blocks[0]).addClass("pip-show")}),this.startInterval(),this._throttled=_.throttle(function(){r.toBlock(a._type,a._blocks,a._index,a._newIndex,a._direction),a._index=a._newIndex,t.selectIndex=a._index,a.setIndex()},700),o.id&&r.registerSlider(o.id,t),e.on("$destroy",function(){a.stopInterval(),r.removeSlider(o.id)})}return t.$inject=["$scope","$element","$attrs","$parse","$timeout","$interval","$pipImageSlider"],t.prototype.nextBlock=function(){this.restartInterval(),this._newIndex=this._index+1===this._blocks.length?0:this._index+1,this._direction="next",this._throttled()},t.prototype.prevBlock=function(){this.restartInterval(),this._newIndex=this._index-1<0?this._blocks.length-1:this._index-1,this._direction="prev",this._throttled()},t.prototype.slideToPrivate=function(t){console.log(this),t===this._index||t>this._blocks.length-1||(this.restartInterval(),this._newIndex=t,this._direction=t>this._index?"next":"prev",this._throttled())},t.prototype.setIndex=function(){this._$attrs.pipImageIndex&&(this.sliderIndex=this._index)},t.prototype.startInterval=function(){var t=this;this._timePromises=this._$interval(function(){t._newIndex=t._index+1===t._blocks.length?0:t._index+1,t._direction="next",t._throttled()},this._interval||this.DEFAULT_INTERVAL)},t.prototype.stopInterval=function(){this._$interval.cancel(this._timePromises)},t.prototype.restartInterval=function(){this.stopInterval(),this.startInterval()},t}();!function(){function t(){return{scope:{sliderIndex:"=pipImageIndex",type:"&pipAnimationType",interval:"&pipAnimationInterval"},controller:i,controllerAs:"vm"}}angular.module("pipImageSlider",["pipSliderButton","pipSliderIndicator","pipImageSlider.Service"]).directive("pipImageSlider",t)}()},{}],5:[function(t,e,o){var i=function(){function t(t){this.ANIMATION_DURATION=550,this._sliders={},this._$timeout=t}return t.$inject=["$timeout"],t.prototype.registerSlider=function(t,e){console.log("reg",e),this._sliders[t]=e},t.prototype.removeSlider=function(t){delete this._sliders[t]},t.prototype.getSliderScope=function(t){return console.log("ggg",this._sliders,"jjj"),this._sliders[t]},t.prototype.nextCarousel=function(t,e){t.addClass("pip-next"),this._$timeout(function(){t.addClass("animated").addClass("pip-show").removeClass("pip-next"),e.addClass("animated").removeClass("pip-show")},100)},t.prototype.prevCarousel=function(t,e){this._$timeout(function(){t.addClass("animated").addClass("pip-show"),e.addClass("animated").addClass("pip-next").removeClass("pip-show")},100)},t.prototype.toBlock=function(t,e,o,i,n){var s=$(e[o]),r=i,a=$(e[r]);"carousel"===t?($(e).removeClass("pip-next").removeClass("pip-prev").removeClass("animated"),!n||"prev"!==n&&"next"!==n?i&&i<o?this.prevCarousel(a,s):this.nextCarousel(a,s):"prev"===n?this.prevCarousel(a,s):this.nextCarousel(a,s)):(s.addClass("animated").removeClass("pip-show"),a.addClass("animated").addClass("pip-show"))},t}();!function(){"use strict";angular.module("pipImageSlider.Service",[]).service("$pipImageSlider",i)}()},{}],6:[function(t,e,o){!function(){"use strict";var t=angular.module("pipSliderButton",[]);t.directive("pipSliderButton",function(){return{scope:{},controller:["$scope","$element","$parse","$attrs","$pipImageSlider",function(t,e,o,i,n){var s=o(i.pipButtonType)(t),r=o(i.pipSliderId)(t);e.on("click",function(){r&&s&&n.getSliderScope(r).vm[s+"Block"]()})}]}})}()},{}],7:[function(t,e,o){!function(){"use strict";var t=angular.module("pipSliderIndicator",[]);t.directive("pipSliderIndicator",function(){return{scope:!1,controller:["$scope","$element","$parse","$attrs","$pipImageSlider",function(t,e,o,i,n){var s=o(i.pipSliderId)(t),r=o(i.pipSlideTo)(t);e.css("cursor","pointer"),e.on("click",function(){!s||r&&r<0||n.getSliderScope(s).vm.slideToPrivate(r)})}]}})}()},{}],8:[function(t,e,o){!function(){"use strict";var t=angular.module("pipMarkdown",["ngSanitize"]);t.run(["$injector",function(t){var e=t.has("pipTranslate")?t.get("pipTranslate"):null;e&&(e.setTranslations("en",{MARKDOWN_ATTACHMENTS:"Attachments:",checklist:"Checklist",documents:"Documents",pictures:"Pictures",location:"Location",time:"Time"}),e.setTranslations("ru",{MARKDOWN_ATTACHMENTS:"Вложения:",checklist:"Список",documents:"Документы",pictures:"Изображения",location:"Местонахождение",time:"Время"}))}]),t.directive("pipMarkdown",["$parse","$injector",function(t,e){var o=e.has("pipTranslate")?e.get("pipTranslate"):null;return{restrict:"EA",scope:!1,link:function(e,i,n){function s(t){var e="",i=[];return _.each(t,function(t){t.type&&"text"!==t.type&&(0===e.length&&o&&(e=o.translate("MARKDOWN_ATTACHMENTS")),i.indexOf(t.type)<0&&(i.push(t.type),e+=i.length>1?", ":" ",o&&(e+=o.translate(t.type))))}),e}function r(t){return null!=t&&(!!t&&(t=t.toString().toLowerCase(),"1"==t||"true"==t))}function a(t){var e,o,r,a,l;_.isArray(t)?(l=_.find(t,function(t){return"text"===t.type&&t.text}),e=l?l.text:s(t)):e=t,o=n.pipLineCount&&_.isNumber(c()),o=o&&e&&e.length>0,a={gfm:!0,tables:!0,breaks:!0,sanitize:!0,pedantic:!0,smartLists:!0,smartypents:!1},e=marked(e||"",a),o&&(r=1.5*c()),i.html("<div"+(o?p()?'class="pip-markdown-content pip-markdown-list" style="max-height: '+r+'em">':' class="pip-markdown-content" style="max-height: '+r+'em">':p()?' class="pip-markdown-list">':">")+e+"</div>"),i.find("a").attr("target","blank"),!p()&&o&&i.append('<div class="pip-gradient-block"></div>')}var l=t(n.pipText),p=t(n.pipList),c=t(n.pipLineCount);a(l(e)),r(n.pipRebind)&&e.$watch(l,function(t){a(t)}),e.$on("pipWindowResized",function(){a(l(e))}),i.addClass("pip-markdown")}}}])}()},{}],9:[function(t,e,o){"use strict";var i=function(){function t(t,e,o,i,n){var s=this;this._$timeout=i,this.templateUrl=t.params.templateUrl,this.template=t.params.template,this.timeout=t.params.timeout,this.element=t.params.element,this.calcH=t.params.calcHeight,this.cancelCallback=t.params.cancelCallback,this.backdropElement=$(".pip-popover-backdrop"),this.backdropElement.on("click keydown scroll",function(){s.backdropClick()}),this.backdropElement.addClass(t.params.responsive!==!1?"pip-responsive":""),i(function(){s.position(),t.params.template&&(s.content=n(t.params.template)(t),o.find(".pip-popover").append(s.content)),s.init()}),i(function(){s.calcHeight()},200),e.$on("pipPopoverResize",function(){s.onResize()}),$(window).resize(function(){s.onResize()})}return t.$inject=["$scope","$rootScope","$element","$timeout","$compile"],t.prototype.backdropClick=function(){this.cancelCallback&&this.cancelCallback(),this.closePopover()},t.prototype.closePopover=function(){var t=this;this.backdropElement.removeClass("opened"),this._$timeout(function(){t.backdropElement.remove()},100)},t.prototype.onPopoverClick=function(t){t.stopPropagation()},t.prototype.init=function(){this.backdropElement.addClass("opened"),$(".pip-popover-backdrop").focus(),this.timeout&&this._$timeout(function(){this.closePopover()},this.timeout)},t.prototype.position=function(){if(this.element){var t=$(this.element),e=t.offset(),o=t.width(),i=t.height(),n=$(document).width(),s=$(document).height(),r=this.backdropElement.find(".pip-popover");e&&r.css("max-width",n-(n-e.left)).css("max-height",s-(e.top+i)-32,0).css("left",e.left-r.width()+o/2).css("top",e.top+i+16)}},t.prototype.onResize=function(){this.backdropElement.find(".pip-popover").find(".pip-content").css("max-height","100%"),this.position(),this.calcHeight()},t.prototype.calcHeight=function(){if(this.calcH!==!1){var t=this.backdropElement.find(".pip-popover"),e=t.find(".pip-title"),o=t.find(".pip-footer"),i=t.find(".pip-content"),n=t.height()-e.outerHeight(!0)-o.outerHeight(!0);i.css("max-height",Math.max(n,0)+"px").css("box-sizing","border-box")}},t}();o.PopoverController=i,function(){function t(t){"ngInject";return{restrict:"EA",scope:!0,templateUrl:"popover/popover.html",controller:i,controllerAs:"vm"}}t.$inject=["$parse"],angular.module("pipPopover",["pipPopover.Service"]).directive("pipPopover",t)}()},{}],10:[function(t,e,o){"use strict";var i=function(){function t(t,e,o){this._$compile=t,this._$rootScope=e,this._$timeout=o,this.popoverTemplate="<div class='pip-popover-backdrop {{ params.class }}' ng-controller='params.controller' tabindex='1'> <pip-popover pip-params='params'> </pip-popover> </div>"}return t.$inject=["$compile","$rootScope","$timeout"],t.prototype.show=function(t){var e,o,i,n;e=$("body"),e.find("md-backdrop").length>0||(this.hide(),o=this._$rootScope.$new(),i=t&&_.isObject(t)?t:{},o.params=i,o.locals=i.locals,n=this._$compile(this.popoverTemplate)(o),e.append(n))},t.prototype.hide=function(){var t=$(".pip-popover-backdrop");t.removeClass("opened"),this._$timeout(function(){t.remove()},100)},t.prototype.resize=function(){this._$rootScope.$broadcast("pipPopoverResize")},t}();o.PopoverService=i,function(){angular.module("pipPopover.Service",[]).service("pipPopoverService",i)}()},{}],11:[function(t,e,o){var i=function(){function t(t,e){this._image=e.children("img"),this.showProgress=t.showProgress,this.logoUrl=t.logoUrl,this.loadProgressImage()}return t.$inject=["$scope","$element"],t.prototype.loadProgressImage=function(){this.logoUrl&&this._image.attr("src",this.logoUrl)},t}();!function(){function t(){return{restrict:"EA",replace:!0,scope:{showProgress:"&",logoUrl:"@"},templateUrl:"progress/routing_progress.html",controller:i,controllerAs:"vm"}}angular.module("pipRoutingProgress",["ngMaterial"]).directive("pipRoutingProgress",t)}()},{}],12:[function(t,e,o){var i=function(){function t(t,e,o){this._pipErrorDetailsDialog=o.has("pipErrorDetailsDialog")?o.get("pipErrorDetailsDialog"):null,this._$mdToast=t,this.message=e.message,this.actions=e.actions,this.toast=e,0===e.actions.length?this.actionLenght=0:this.actionLenght=1===e.actions.length?e.actions[0].toString().length:null,this.showDetails=null!=this._pipErrorDetailsDialog}return t.prototype.onDetails=function(){this._$mdToast.hide(),this._pipErrorDetailsDialog&&this._pipErrorDetailsDialog.show({error:this.toast.error,ok:"Ok"},angular.noop,angular.noop)},t.prototype.onAction=function(t){this._$mdToast.hide({action:t,id:this.toast.id,message:this.message})},t}(),n=function(){function t(t,e){var o=this;this.SHOW_TIMEOUT=2e4,this.SHOW_TIMEOUT_NOTIFICATIONS=2e4,this.toasts=[],this.sounds={},this._$mdToast=e,t.$on("$stateChangeSuccess",function(){o.onStateChangeSuccess()}),t.$on("pipSessionClosed",function(){o.onClearToasts()}),t.$on("pipIdentityChanged",function(){o.onClearToasts()})}return t.$inject=["$rootScope","$mdToast"],t.prototype.showNextToast=function(){var t;this.toasts.length>0&&(t=this.toasts[0],this.toasts.splice(0,1),this.showToast(t))},t.prototype.showToast=function(t){var e=this;this.currentToast=t,this._$mdToast.show({templateUrl:"toast/toast.html",hideDelay:t.duration||this.SHOW_TIMEOUT,position:"bottom left",controller:i,controllerAs:"vm",locals:{toast:this.currentToast,sounds:this.sounds}}).then(function(t){e.showToastOkResult(t)},function(t){e.showToastCancelResult(t)})},t.prototype.showToastCancelResult=function(t){this.currentToast.cancelCallback&&this.currentToast.cancelCallback(t),this.currentToast=null,this.showNextToast()},t.prototype.showToastOkResult=function(t){this.currentToast.successCallback&&this.currentToast.successCallback(t),this.currentToast=null,this.showNextToast()},t.prototype.addToast=function(t){this.currentToast&&"error"!==t.type?this.toasts.push(t):this.showToast(t)},t.prototype.removeToasts=function(t){var e=[];_.each(this.toasts,function(o){o.type&&o.type===t||e.push(o)}),this.toasts=_.cloneDeep(e)},t.prototype.removeToastsById=function(t){_.remove(this.toasts,{id:t})},t.prototype.getToastById=function(t){return _.find(this.toasts,{id:t})},t.prototype.onStateChangeSuccess=function(){},t.prototype.onClearToasts=function(){this.clearToasts(null)},t.prototype.showNotification=function(t,e,o,i,n){this.addToast({id:n||null,type:"notification",message:t,actions:e||["ok"],successCallback:o,cancelCallback:i,duration:this.SHOW_TIMEOUT_NOTIFICATIONS})},t.prototype.showMessage=function(t,e,o,i){this.addToast({id:i||null,type:"message",message:t,actions:["ok"],successCallback:e,cancelCallback:o})},t.prototype.showError=function(t,e,o,i,n){this.addToast({id:i||null,error:n,type:"error",message:t||"Unknown error.",actions:["ok"],successCallback:e,cancelCallback:o})},t.prototype.hideAllToasts=function(){this._$mdToast.cancel(),this.toasts=[]},t.prototype.clearToasts=function(t){t?this.removeToasts(t):(this._$mdToast.cancel(),this.toasts=[])},t}();!function(){angular.module("pipToasts",["ngMaterial","pipControls.Translate"]).service("pipToasts",n)}()},{}],13:[function(t,e,o){!function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("color_picker/color_picker.html",'<ul class="pip-color-picker {{vm.class}}" pip-selected="vm.currentColorIndex" pip-enter-space-press="vm.enterSpacePress($event)"><li tabindex="-1" ng-repeat="color in vm.colors track by color"><md-button tabindex="-1" class="md-icon-button pip-selectable" ng-click="vm.selectColor($index)" aria-label="color" ng-disabled="vm.disabled()"><md-icon ng-style="{\'color\': color}" md-svg-icon="icons:{{ color == vm.currentColor ? \'circle\' : \'radio-off\' }}"></md-icon></md-button></li></ul>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("popover/popover.html",'<div ng-if="vm.templateUrl" class="pip-popover flex layout-column" ng-click="vm.onPopoverClick($event)" ng-include="vm.templateUrl"></div><div ng-if="vm.template" class="pip-popover" ng-click="vm.onPopoverClick($event)"></div>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("progress/routing_progress.html",'<div class="pip-routing-progress layout-column layout-align-center-center" ng-show="vm.showProgress()"><div class="loader"><svg class="circular" viewbox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle></svg></div><img src="" height="40" width="40" class="pip-img"><md-progress-circular md-diameter="96" class="fix-ie"></md-progress-circular></div>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("toast/toast.html",'<md-toast class="md-action pip-toast" ng-class="{\'pip-error\': vm.toast.type==\'error\', \'pip-column-toast\': vm.toast.actions.length > 1 || vm.actionLenght > 4, \'pip-no-action-toast\': vm.actionLenght == 0}" style="height:initial; max-height: initial;"><span class="flex-var pip-text" ng-bind-html="vm.message"></span><div class="layout-row layout-align-end-start pip-actions" ng-if="vm.actions.length > 0 || (vm.toast.type==\'error\' && vm.toast.error)"><div class="flex" ng-if="vm.toast.actions.length > 1"></div><md-button class="flex-fixed pip-toast-button" ng-if="vm.toast.type==\'error\' && vm.toast.error && vm.showDetails" ng-click="vm.onDetails()">Details</md-button><md-button class="flex-fixed pip-toast-button" ng-click="vm.onAction(action)" ng-repeat="action in vm.actions" aria-label="{{::action| translate}}">{{::action| translate}}</md-button></div></md-toast>')}])}()},{}]},{},[13,1,2,3,5,4,6,7,8,10,9,11,12])(13)});
//# sourceMappingURL=pip-webui-controls.min.js.map
