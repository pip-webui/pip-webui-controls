!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.pip||(e.pip={})).controls=t()}}(function(){return function t(e,o,i){function s(r,a){if(!o[r]){if(!e[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(n)return n(r,!0);var p=new Error("Cannot find module '"+r+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[r]={exports:{}};e[r][0].call(c.exports,function(t){var o=e[r][1][t];return s(o?o:t)},c,c.exports,t,e,o,i)}return o[r].exports}for(var n="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}({1:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=["purple","lightgreen","green","darkred","pink","yellow","cyan"],s=function(){function t(t,e,o,s){this._$timeout=s,this._$scope=t,this.class=o.class||"",this.colors=!t.vm.colors||_.isArray(t.vm.colors)&&0===t.vm.colors.length?i:t.vm.colors,this.colorChange=t.vm.colorChange||null,this.currentColor=t.vm.currentColor||this.colors[0],this.currentColorIndex=this.colors.indexOf(this.currentColor),this.ngDisabled=t.vm.ngDisabled||!1}return t.prototype.$onChanges=function(t){this.colors=_.isArray(t.colors.currentValue)&&0!==t.colors.currentValue.length?t.colors.currentValue:i,this.currentColor=t.currentColor.currentValue||this.colors[0]},t.prototype.disabled=function(){return!!this.ngDisabled},t.prototype.selectColor=function(t){var e=this;this.disabled()||(this.currentColorIndex=t,this.currentColor=this.colors[this.currentColorIndex],this._$timeout(function(){e._$scope.$apply()}),this.colorChange&&this.colorChange())},t.prototype.enterSpacePress=function(t){this.selectColor(t.index)},t}();o.ColorPickerController=s;var n={bindings:{ngDisabled:"<?ngDisabled",colors:"<pipColors",currentColor:"=ngModel",colorChange:"<?ngChange"},templateUrl:"color_picker/color_picker.html",controller:s,controllerAs:"vm"};angular.module("pipColorPicker",["pipControls.Templates"]).component("pipColorPicker",n)},{}],2:[function(t,e,o){!function(){"use strict";angular.module("pipControls",["pipMarkdown","pipColorPicker","pipRoutingProgress","pipPopover","pipImageSlider","pipToasts","pipControls.Translate"])}()},{}],3:[function(t,e,o){!function(){"use strict";var t=angular.module("pipControls.Translate",[]);t.filter("translate",["$injector",function(t){var e=t.has("pipTranslate")?t.get("pipTranslate"):null;return function(t){return e?e.translate(t)||t:t}}])}()},{}],4:[function(t,e,o){var i=function(){function t(t,e,o,i,s,n,r){var a=this;this._index=0,this.DEFAULT_INTERVAL=4500,this.swipeStart=0,this.sliderIndex=t.vm.sliderIndex,this._type=t.vm.type(),this._interval=t.vm.interval(),this._$attrs=o,this._$interval=n,this._$scope=t,t.slideTo=this.slideToPrivate,e.addClass("pip-image-slider"),e.addClass("pip-animation-"+this._type),this.setIndex(),s(function(){a._blocks=e.find(".pip-animation-block"),a._blocks.length>0&&$(a._blocks[0]).addClass("pip-show")}),this.startInterval(),this._throttled=_.throttle(function(){r.toBlock(a._type,a._blocks,a._index,a._newIndex,a._direction),a._index=a._newIndex,a.setIndex()},700),o.id&&r.registerSlider(o.id,t),e.on("$destroy",function(){a.stopInterval(),r.removeSlider(o.id)})}return t.$inject=["$scope","$element","$attrs","$parse","$timeout","$interval","pipImageSlider"],t.prototype.nextBlock=function(){this.restartInterval(),this._newIndex=this._index+1===this._blocks.length?0:this._index+1,this._direction="next",this._throttled()},t.prototype.prevBlock=function(){this.restartInterval(),this._newIndex=this._index-1<0?this._blocks.length-1:this._index-1,this._direction="prev",this._throttled()},t.prototype.slideToPrivate=function(t){t===this._index||t>this._blocks.length-1||(this.restartInterval(),this._newIndex=t,this._direction=t>this._index?"next":"prev",this._throttled())},t.prototype.setIndex=function(){this._$attrs.pipImageIndex&&(this.sliderIndex=this._index)},t.prototype.startInterval=function(){var t=this;this._timePromises=this._$interval(function(){t._newIndex=t._index+1===t._blocks.length?0:t._index+1,t._direction="next",t._throttled()},this._interval||this.DEFAULT_INTERVAL)},t.prototype.stopInterval=function(){this._$interval.cancel(this._timePromises)},t.prototype.restartInterval=function(){this.stopInterval(),this.startInterval()},t}();!function(){function t(){return{scope:{sliderIndex:"=pipImageIndex",type:"&pipAnimationType",interval:"&pipAnimationInterval"},bindToController:!0,controller:i,controllerAs:"vm"}}angular.module("pipImageSlider",["pipSliderButton","pipSliderIndicator","pipImageSlider.Service"]).directive("pipImageSlider",t)}()},{}],5:[function(t,e,o){var i=function(){function t(t){this.ANIMATION_DURATION=550,this._sliders={},this._$timeout=t}return t.$inject=["$timeout"],t.prototype.registerSlider=function(t,e){this._sliders[t]=e},t.prototype.removeSlider=function(t){delete this._sliders[t]},t.prototype.getSliderScope=function(t){return this._sliders[t]},t.prototype.nextCarousel=function(t,e){t.addClass("pip-next"),this._$timeout(function(){t.addClass("animated").addClass("pip-show").removeClass("pip-next"),e.addClass("animated").removeClass("pip-show")},100)},t.prototype.prevCarousel=function(t,e){this._$timeout(function(){t.addClass("animated").addClass("pip-show"),e.addClass("animated").addClass("pip-next").removeClass("pip-show")},100)},t.prototype.toBlock=function(t,e,o,i,s){var n=$(e[o]),r=i,a=$(e[r]);"carousel"===t?($(e).removeClass("pip-next").removeClass("pip-prev").removeClass("animated"),!s||"prev"!==s&&"next"!==s?i&&i<o?this.prevCarousel(a,n):this.nextCarousel(a,n):"prev"===s?this.prevCarousel(a,n):this.nextCarousel(a,n)):(n.addClass("animated").removeClass("pip-show"),a.addClass("animated").addClass("pip-show"))},t}();!function(){"use strict";angular.module("pipImageSlider.Service",[]).service("pipImageSlider",i)}()},{}],6:[function(t,e,o){!function(){"use strict";var t=angular.module("pipSliderButton",[]);t.directive("pipSliderButton",function(){return{scope:{},controller:["$scope","$element","$parse","$attrs","pipImageSlider",function(t,e,o,i,s){var n=o(i.pipButtonType)(t),r=o(i.pipSliderId)(t);e.on("click",function(){r&&n&&s.getSliderScope(r).vm[n+"Block"]()})}]}})}()},{}],7:[function(t,e,o){!function(){"use strict";var t=angular.module("pipSliderIndicator",[]);t.directive("pipSliderIndicator",function(){return{scope:!1,controller:["$scope","$element","$parse","$attrs","pipImageSlider",function(t,e,o,i,s){var n=o(i.pipSliderId)(t),r=o(i.pipSlideTo)(t);e.css("cursor","pointer"),e.on("click",function(){!n||r&&r<0||s.getSliderScope(n).vm.slideToPrivate(r)})}]}})}()},{}],8:[function(t,e,o){function i(t){var e=t.has("pipTranslate")?t.get("pipTranslate"):null;e&&(e.setTranslations("en",{MARKDOWN_ATTACHMENTS:"Attachments:",checklist:"Checklist",documents:"Documents",pictures:"Pictures",location:"Location",time:"Time"}),e.setTranslations("ru",{MARKDOWN_ATTACHMENTS:"Вложения:",checklist:"Список",documents:"Документы",pictures:"Изображения",location:"Местонахождение",time:"Время"}))}i.$inject=["$injector"];var s=function(){function t(t,e,o,i,s){this._pipTranslate=s.has("pipTranslate")?s.get("pipTranslate"):null,this._$parse=e,this._$scope=t,this._$injector=s,this._$element=i,this._$attrs=o,this._text=t.$ctrl.text,this._isList=t.$ctrl.isList,this._clamp=t.$ctrl.clamp,this._rebind=t.$ctrl.rebind}return t.prototype.$postLink=function(){this.bindText(this._text),this._$scope.$on("pipWindowResized",function(){this.bindText&&this.bindText(this._text(this._$scope))}),this._$element.addClass("pip-markdown")},t.prototype.$onChanges=function(t){var e=t.text.currentValue;this._rebind&&this._text!==e&&(this._text=e,this.bindText(this._text))},t.prototype.describeAttachments=function(t){var e="",o=[];return _.each(t,function(t){t.type&&"text"!==t.type&&(0===e.length&&this._pipTranslate&&(e=this._pipTranslate.translate("MARKDOWN_ATTACHMENTS")),o.indexOf(t.type)<0&&(o.push(t.type),e+=o.length>1?", ":" ",this._pipTranslate&&(e+=this._pipTranslate.translate(t.type))))}),e},t.prototype.bindText=function(t){var e,o,i,s,n;_.isArray(t)?(n=_.find(t,function(t){return"text"===t.type&&t.text}),e=n?n.text:this.describeAttachments(t)):e=t,o=this._$attrs.pipLineCount&&_.isNumber(this._clamp),o=o&&e&&e.length>0,s={gfm:!0,tables:!0,breaks:!0,sanitize:!0,pedantic:!0,smartLists:!0,smartypents:!1},e=marked(e||"",s),o&&(i=1.5*this._clamp),this._$element.html("<div"+(o?this._isList?'class="pip-markdown-content pip-markdown-list" style="max-height: '+i+'em">':' class="pip-markdown-content" style="max-height: '+i+'em">':this._isList?' class="pip-markdown-list">':">")+e+"</div>"),this._$element.find("a").attr("target","blank"),!this._isList&&o&&this._$element.append('<div class="pip-gradient-block"></div>')},t}();!function(){"use strict";var t={controller:s,bindings:{text:"<pipText",isList:"<?pipList",clamp:"<?pipLineCount",rebind:"<?pipRebind"}};angular.module("pipMarkdown",["ngSanitize"]).run(i).component("pipMarkdown",t)}()},{}],9:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e,o,i,s){var n=this;this._$timeout=i,this.templateUrl=t.params.templateUrl,this.template=t.params.template,this.timeout=t.params.timeout,this.element=t.params.element,this.calcH=t.params.calcHeight,this.cancelCallback=t.params.cancelCallback,this.backdropElement=$(".pip-popover-backdrop"),this.backdropElement.on("click keydown scroll",function(){n.backdropClick()}),this.backdropElement.addClass(t.params.responsive!==!1?"pip-responsive":""),i(function(){n.position(),t.params.template&&(n.content=s(t.params.template)(t),o.find(".pip-popover").append(n.content)),n.init()}),i(function(){n.calcHeight()},200),e.$on("pipPopoverResize",function(){n.onResize()}),$(window).resize(function(){n.onResize()})}return t.$inject=["$scope","$rootScope","$element","$timeout","$compile"],t.prototype.backdropClick=function(){this.cancelCallback&&this.cancelCallback(),this.closePopover()},t.prototype.closePopover=function(){var t=this;this.backdropElement.removeClass("opened"),this._$timeout(function(){t.backdropElement.remove()},100)},t.prototype.onPopoverClick=function(t){t.stopPropagation()},t.prototype.init=function(){this.backdropElement.addClass("opened"),$(".pip-popover-backdrop").focus(),this.timeout&&this._$timeout(function(){this.closePopover()},this.timeout)},t.prototype.position=function(){if(this.element){var t=$(this.element),e=t.offset(),o=t.width(),i=t.height(),s=$(document).width(),n=$(document).height(),r=this.backdropElement.find(".pip-popover");e&&r.css("max-width",s-(s-e.left)).css("max-height",n-(e.top+i)-32,0).css("left",e.left-r.width()+o/2).css("top",e.top+i+16)}},t.prototype.onResize=function(){this.backdropElement.find(".pip-popover").find(".pip-content").css("max-height","100%"),this.position(),this.calcHeight()},t.prototype.calcHeight=function(){if(this.calcH!==!1){var t=this.backdropElement.find(".pip-popover"),e=t.find(".pip-title"),o=t.find(".pip-footer"),i=t.find(".pip-content"),s=t.height()-e.outerHeight(!0)-o.outerHeight(!0);i.css("max-height",Math.max(s,0)+"px").css("box-sizing","border-box")}},t}();o.PopoverController=i,function(){function t(t){"ngInject";return{restrict:"EA",scope:!0,templateUrl:"popover/popover.html",controller:i,controllerAs:"vm"}}t.$inject=["$parse"],angular.module("pipPopover",["pipPopover.Service"]).directive("pipPopover",t)}()},{}],10:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e,o){this._$compile=t,this._$rootScope=e,this._$timeout=o,this.popoverTemplate="<div class='pip-popover-backdrop {{ params.class }}' ng-controller='params.controller' tabindex='1'> <pip-popover pip-params='params'> </pip-popover> </div>"}return t.$inject=["$compile","$rootScope","$timeout"],t.prototype.show=function(t){var e,o,i,s;e=$("body"),e.find("md-backdrop").length>0||(this.hide(),o=this._$rootScope.$new(),i=t&&_.isObject(t)?t:{},o.params=i,o.locals=i.locals,s=this._$compile(this.popoverTemplate)(o),e.append(s))},t.prototype.hide=function(){var t=$(".pip-popover-backdrop");t.removeClass("opened"),this._$timeout(function(){t.remove()},100)},t.prototype.resize=function(){this._$rootScope.$broadcast("pipPopoverResize")},t}();o.PopoverService=i,function(){angular.module("pipPopover.Service",[]).service("pipPopoverService",i)}()},{}],11:[function(t,e,o){var i=function(){function t(t,e){this._$element=e,this.showProgress=t.vm.showProgress,this.logoUrl=t.vm.logoUrl}return t.prototype.$postLink=function(){this._image=this._$element.find("img"),this.loadProgressImage()},t.prototype.loadProgressImage=function(){this.logoUrl&&this._image.attr("src",this.logoUrl)},t}();!function(){var t={replace:!0,bindings:{showProgress:"&",logoUrl:"@"},templateUrl:"progress/routing_progress.html",controller:i,controllerAs:"vm"};angular.module("pipRoutingProgress",["ngMaterial"]).component("pipRoutingProgress",t)}()},{}],12:[function(t,e,o){var i=function(){function t(t,e,o){this._pipErrorDetailsDialog=o.has("pipErrorDetailsDialog")?o.get("pipErrorDetailsDialog"):null,this._$mdToast=t,this.message=e.message,this.actions=e.actions,this.toast=e,0===e.actions.length?this.actionLenght=0:this.actionLenght=1===e.actions.length?e.actions[0].toString().length:null,this.showDetails=null!=this._pipErrorDetailsDialog}return t.prototype.onDetails=function(){this._$mdToast.hide(),this._pipErrorDetailsDialog&&this._pipErrorDetailsDialog.show({error:this.toast.error,ok:"Ok"},angular.noop,angular.noop)},t.prototype.onAction=function(t){this._$mdToast.hide({action:t,id:this.toast.id,message:this.message})},t}(),s=function(){function t(t,e){var o=this;this.SHOW_TIMEOUT=2e4,this.SHOW_TIMEOUT_NOTIFICATIONS=2e4,this.toasts=[],this.sounds={},this._$mdToast=e,t.$on("$stateChangeSuccess",function(){o.onStateChangeSuccess()}),t.$on("pipSessionClosed",function(){o.onClearToasts()}),t.$on("pipIdentityChanged",function(){o.onClearToasts()})}return t.$inject=["$rootScope","$mdToast"],t.prototype.showNextToast=function(){var t;this.toasts.length>0&&(t=this.toasts[0],this.toasts.splice(0,1),this.showToast(t))},t.prototype.showToast=function(t){var e=this;this.currentToast=t,this._$mdToast.show({templateUrl:"toast/toast.html",hideDelay:t.duration||this.SHOW_TIMEOUT,position:"bottom left",controller:i,controllerAs:"vm",locals:{toast:this.currentToast,sounds:this.sounds}}).then(function(t){e.showToastOkResult(t)},function(t){e.showToastCancelResult(t)})},t.prototype.showToastCancelResult=function(t){this.currentToast.cancelCallback&&this.currentToast.cancelCallback(t),this.currentToast=null,this.showNextToast()},t.prototype.showToastOkResult=function(t){this.currentToast.successCallback&&this.currentToast.successCallback(t),this.currentToast=null,this.showNextToast()},t.prototype.addToast=function(t){this.currentToast&&"error"!==t.type?this.toasts.push(t):this.showToast(t)},t.prototype.removeToasts=function(t){var e=[];_.each(this.toasts,function(o){o.type&&o.type===t||e.push(o)}),this.toasts=_.cloneDeep(e)},t.prototype.removeToastsById=function(t){_.remove(this.toasts,{id:t})},t.prototype.getToastById=function(t){return _.find(this.toasts,{id:t})},t.prototype.onStateChangeSuccess=function(){},t.prototype.onClearToasts=function(){this.clearToasts(null)},t.prototype.showNotification=function(t,e,o,i,s){this.addToast({id:s||null,type:"notification",message:t,actions:e||["ok"],successCallback:o,cancelCallback:i,duration:this.SHOW_TIMEOUT_NOTIFICATIONS})},t.prototype.showMessage=function(t,e,o,i){this.addToast({id:i||null,type:"message",message:t,actions:["ok"],successCallback:e,cancelCallback:o})},t.prototype.showError=function(t,e,o,i,s){this.addToast({id:i||null,error:s,type:"error",message:t||"Unknown error.",actions:["ok"],successCallback:e,cancelCallback:o})},t.prototype.hideAllToasts=function(){this._$mdToast.cancel(),this.toasts=[]},t.prototype.clearToasts=function(t){t?this.removeToasts(t):(this._$mdToast.cancel(),this.toasts=[])},t}();!function(){angular.module("pipToasts",["ngMaterial","pipControls.Translate"]).service("pipToasts",s)}()},{}],13:[function(t,e,o){!function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("color_picker/color_picker.html",'<ul class="pip-color-picker {{vm.class}}" pip-selected="vm.currentColorIndex" pip-enter-space-press="vm.enterSpacePress($event)"><li tabindex="-1" ng-repeat="color in vm.colors track by color"><md-button tabindex="-1" class="md-icon-button pip-selectable" ng-click="vm.selectColor($index)" aria-label="color" ng-disabled="vm.disabled()"><md-icon ng-style="{\'color\': color}" md-svg-icon="icons:{{ color == vm.currentColor ? \'circle\' : \'radio-off\' }}"></md-icon></md-button></li></ul>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("popover/popover.html",'<div ng-if="vm.templateUrl" class="pip-popover flex layout-column" ng-click="vm.onPopoverClick($event)" ng-include="vm.templateUrl"></div><div ng-if="vm.template" class="pip-popover" ng-click="vm.onPopoverClick($event)"></div>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("toast/toast.html",'<md-toast class="md-action pip-toast" ng-class="{\'pip-error\': vm.toast.type==\'error\', \'pip-column-toast\': vm.toast.actions.length > 1 || vm.actionLenght > 4, \'pip-no-action-toast\': vm.actionLenght == 0}" style="height:initial; max-height: initial;"><span class="flex-var pip-text" ng-bind-html="vm.message"></span><div class="layout-row layout-align-end-start pip-actions" ng-if="vm.actions.length > 0 || (vm.toast.type==\'error\' && vm.toast.error)"><div class="flex" ng-if="vm.toast.actions.length > 1"></div><md-button class="flex-fixed pip-toast-button" ng-if="vm.toast.type==\'error\' && vm.toast.error && vm.showDetails" ng-click="vm.onDetails()">Details</md-button><md-button class="flex-fixed pip-toast-button" ng-click="vm.onAction(action)" ng-repeat="action in vm.actions" aria-label="{{::action| translate}}">{{::action| translate}}</md-button></div></md-toast>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("progress/routing_progress.html",'<div class="pip-routing-progress layout-column layout-align-center-center" ng-show="vm.showProgress()"><div class="loader"><svg class="circular" viewbox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle></svg></div><img src="" height="40" width="40" class="pip-img"><md-progress-circular md-diameter="96" class="fix-ie"></md-progress-circular></div>')}])}()},{}]},{},[13,1,2,3,5,4,6,7,8,10,9,11,12])(13)});
//# sourceMappingURL=pip-webui-controls.min.js.map
