!function(e){"use strict";e.module("pipControls",["pipMarkdown","pipToggleButtons","pipRefreshButton","pipColorPicker","pipRoutingProgress","pipPopover","pipImageSlider","pipToasts","pipTagList","pipUnsavedChanges","pipFabTooltipVisibility"])}(window.angular),function(e){try{e=angular.module("pipBasicControls.Templates")}catch(t){e=angular.module("pipBasicControls.Templates",[])}e.run(["$templateCache",function(e){e.put("color_picker/color_picker.html",'<ul class="pip-color-picker lp0 {{class}}" pip-selected="currentColorIndex" pip-enter-space-press="enterSpacePress($event)"><li tabindex="-1" ng-repeat="color in colors track by color"><md-button tabindex="-1" class="md-icon-button pip-selectable" ng-click="selectColor($index)" aria-label="color" ng-disabled="disabled()"><md-icon ng-style="{\'color\': color}" md-svg-icon="icons:{{ color == currentColor ? \'circle\' : \'radio-off\' }}"></md-icon></md-button></li></ul>')}])}(),function(e){try{e=angular.module("pipBasicControls.Templates")}catch(t){e=angular.module("pipBasicControls.Templates",[])}e.run(["$templateCache",function(e){e.put("popover/popover.template.html",'<div ng-if="params.templateUrl" class="pip-popover flex layout-column" ng-click="onPopoverClick($event)" ng-include="params.templateUrl"></div><div ng-if="params.template" class="pip-popover" ng-click="onPopoverClick($event)"></div>')}])}(),function(e){try{e=angular.module("pipBasicControls.Templates")}catch(t){e=angular.module("pipBasicControls.Templates",[])}e.run(["$templateCache",function(e){e.put("progress/routing_progress.html",'<div class="pip-routing-progress layout-column layout-align-center-center" ng-show="showProgress()"><div class="loader"><svg class="circular" viewbox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle></svg></div><img src="" height="40" width="40" class="pip-img"><md-progress-circular md-diameter="96" class="fix-ie"></md-progress-circular></div>')}])}(),function(e){try{e=angular.module("pipBasicControls.Templates")}catch(t){e=angular.module("pipBasicControls.Templates",[])}e.run(["$templateCache",function(e){e.put("tags/tag_list.html",'<div class="pip-chip rm4 pip-type-chip pip-type-chip-left {{\'bg-\' + pipType + \'-chips\'}}" ng-if="pipType && !pipTypeLocal"><span>{{pipType.toUpperCase() | translate | uppercase}}</span></div><div class="pip-chip rm4 pip-type-chip pip-type-chip-left {{\'bg-\' + pipType + \'-chips\'}}" ng-if="pipType && pipTypeLocal"><span>{{pipTypeLocal.toUpperCase() | translate | uppercase}}</span></div><div class="pip-chip rm4" ng-repeat="tag in pipTags"><span>{{::tag}}</span></div>')}])}(),function(e){try{e=angular.module("pipBasicControls.Templates")}catch(t){e=angular.module("pipBasicControls.Templates",[])}e.run(["$templateCache",function(e){e.put("toast/toast.html",'<md-toast class="md-action pip-toast" ng-class="{\'pip-error\': toast.type==\'error\', \'pip-column-toast\': toast.type == \'error\' || toast.actions.length > 1 || actionLenght > 4, \'pip-no-action-toast\': actionLenght == 0}" style="height:initial; max-height: initial;"><span class="flex-var m0 pip-text" ng-bind-html="message"></span><div class="layout-row layout-align-end-start" ng-if="actions.length > 0 || (toast.type==\'error\' && toast.error)"><md-button class="flex-fixed m0 lm8" ng-if="toast.type==\'error\' && toast.error" ng-click="onDetails()">Details</md-button><md-button class="flex-fixed m0 lm8" ng-click="onAction(action)" ng-repeat="action in actions" aria-label="{{::action| translate}}">{{::action| translate}}</md-button></div></md-toast>')}])}(),function(e){try{e=angular.module("pipBasicControls.Templates")}catch(t){e=angular.module("pipBasicControls.Templates",[])}e.run(["$templateCache",function(e){e.put("toggle_buttons/toggle_buttons.html",'<div class="pip-toggle-buttons flex layout-row {{class}}" pip-selected="bufButtonIndex" pip-enter-space-press="enterSpacePress($event)" ng-if="$mdMedia(\'gt-xs\')"><md-button tabindex="-1" ng-repeat="button in buttons" ng-class="{\'md-accent md-raised selected color-accent-bg\' : currentButtonIndex == $index}" ng-attr-style="{{ \'background-color:\' + (currentButtonIndex == $index ? button.backgroundColor : \'\') + \'!important\' }}" class="pip-selectable pip-chip-button flex" ng-click="buttonSelected($index, $event)" ng-disabled="button.disabled || disabled()">{{button.name || button.title | translate}} <span ng-if="button.checked || button.complete || button.filled" class="pip-tagged">*</span></md-button></div><md-input-container class="md-block" ng-if="$mdMedia(\'xs\')"><md-select ng-model="currentButtonIndex" ng-disabled="disabled()" aria-label="DROPDOWN" md-on-close="buttonSelected(currentButtonIndex)"><md-option ng-repeat="action in buttons" value="{{ ::$index }}">{{ (action.title || action.name) | translate }} <span ng-if="action.checked || action.complete || action.filled" class="pip-tagged">*</span></md-option></md-select></md-input-container>')}])}(),function(){"use strict";var e=angular.module("pipFabTooltipVisibility",[]);e.directive("pipFabTooltipVisibility",["$parse","$timeout",function(e,t){return{restrict:"A",scope:!1,controller:["$scope","$attrs",function(n,o){var i=e(o.pipFabTooltipVisibility),s=e(o.pipFabShowTooltip),a=s.assign;n.$watch(i,function(e){e?t(function(){a(n,e)},600):a(n,e)})}]}}])}(),function(e,t){"use strict";var n=e.module("pipColorPicker",["pipUtils","pipFocused","pipBasicControls.Templates"]);n.directive("pipColorPicker",function(){return{restrict:"EA",scope:{ngDisabled:"&",colors:"=pipColors",currentColor:"=ngModel",colorChange:"&ngChange"},templateUrl:"color_picker/color_picker.html",controller:"pipColorPickerController"}}),n.controller("pipColorPickerController",["$scope","$element","$attrs","$timeout",function(e,n,o,i){var s=["purple","lightgreen","green","darkred","pink","yellow","cyan"];e.class=o.class||"",(!e.colors||t.isArray(e.colors)&&0===e.colors.length)&&(e.colors=s),e.currentColor=e.currentColor||e.colors[0],e.currentColorIndex=e.colors.indexOf(e.currentColor),e.disabled=function(){return!e.ngDisabled||e.ngDisabled()},e.selectColor=function(t){e.disabled()||(e.currentColorIndex=t,e.currentColor=e.colors[e.currentColorIndex],i(function(){e.$apply()}),e.colorChange&&e.colorChange())},e.enterSpacePress=function(t){e.selectColor(t.index)}}])}(window.angular,window._),function(e,t,n){"use strict";var o=e.module("pipImageSlider",[]);o.directive("pipImageSlider",function(){return{scope:!1,controller:["$scope","$element","$attrs","$parse","$timeout","$interval","$pipImageSlider",function(e,o,i,s,a,r,p){function c(){b&&b(e,C)}function l(){h=r(function(){m=C+1===g.length?0:C+1,f="next",v()},k||$)}function u(){r.cancel(h)}function d(){u(),l()}var g,m,f,h,v,b=s(i.pipImageSliderIndex).assign,C=0,w=s(i.pipAnimationType)(e),$=4500,k=s(i.pipAnimationInterval)(e);o.addClass("pip-image-slider"),o.addClass("pip-animation-"+w),e.swipeStart=0,c(),a(function(){g=o.find(".pip-animation-block"),g.length>0&&n(g[0]).addClass("pip-show")}),l(),v=t.throttle(function(){p.toBlock(w,g,C,m,f),C=m,c()},600),e.nextBlock=function(){d(),m=C+1===g.length?0:C+1,f="next",v()},e.prevBlock=function(){d(),m=C-1<0?g.length-1:C-1,f="prev",v()},e.slideTo=function(e){e===C||e>g.length-1||(d(),m=e,f=e>C?"next":"prev",v())},o.on("$destroy",function(){u()})}]}}),o.directive("pipSliderButton",function(){return{scope:{},controller:["$scope","$element","$parse","$attrs",function(t,n,o,i){var s=o(i.pipButtonType)(t),a=o(i.pipSliderId)(t);n.on("click",function(){a&&s&&e.element(document.getElementById(a)).scope()[s+"Block"]()})}]}}),o.directive("pipSliderIndicator",function(){return{scope:!1,controller:["$scope","$element","$parse","$attrs",function(t,n,o,i){var s=o(i.pipSliderId)(t),a=o(i.pipSlideTo)(t);n.css("cursor","pointer"),n.on("click",function(){!s||a&&a<0||e.element(document.getElementById(s)).scope().slideTo(a)})}]}}),o.service("$pipImageSlider",["$timeout",function(e){function t(t,n){t.removeClass("animated").addClass("pip-next"),e(function(){t.addClass("animated").addClass("pip-show").removeClass("pip-next"),n.addClass("animated").removeClass("pip-show")},100)}function o(t,n){t.removeClass("animated"),e(function(){t.addClass("animated").addClass("pip-show"),n.addClass("animated").addClass("pip-next").removeClass("pip-show"),e(function(){n.removeClass("pip-next").removeClass("animated")},s-100)},100)}function i(e,i,s,a,r){var p=n(i[s]),c=a,l=n(i[c]);"carousel"===e?(n(i).removeClass("pip-next").removeClass("pip-prev"),r&&"prev"===r&&o(l,p),r&&"next"===r&&t(l,p),(!r||"next"!==r&&"prev"!==r)&&a&&a<s?o(l,p):t(l,p)):(p.addClass("animated").removeClass("pip-show"),l.addClass("animated").addClass("pip-show"))}var s=550;return{nextCarousel:t,prevCarousel:o,toBlock:i}}])}(window.angular,window._,window.jQuery),function(e,t,n){"use strict";var o=e.module("pipMarkdown",["ngSanitize","pipUtils","pipTranslate"]);o.config(["pipTranslateProvider",function(e){e.translations("en",{MARKDOWN_ATTACHMENTS:"Attachments:",checklist:"Checklist",documents:"Documents",pictures:"Pictures",location:"Location",time:"Time"}),e.translations("ru",{MARKDOWN_ATTACHMENTS:"Вложения:",checklist:"Список",documents:"Документы",pictures:"Изображения",location:"Местонахождение",time:"Время"})}]),o.directive("pipMarkdown",["$parse","pipUtils","pipTranslate",function(e,o,i){return{restrict:"EA",scope:!1,link:function(s,a,r){function p(e){var t="",o=[];return n.each(e,function(e){e.type&&"text"!==e.type&&(0===t.length&&(t=i.translate("MARKDOWN_ATTACHMENTS")),o.indexOf(e.type)<0&&(o.push(e.type),t+=o.length>1?", ":" ",t+=i.translate(e.type)))}),t}function c(e){var o,i,s,c,l;n.isArray(e)?(l=n.find(e,function(e){return"text"===e.type&&e.text}),o=l?l.text:p(e)):o=e,i=r.pipLineCount&&n.isNumber(d()),i=i&&o&&o.length>0,c={gfm:!0,tables:!0,breaks:!0,sanitize:!0,pedantic:!0,smartLists:!0,smartypents:!1},o=t(o||"",c),i&&(s=1.5*d()),a.html("<div"+(i?u()?'class="pip-markdown-content pip-markdown-list" style="max-height: '+s+'em">':' class="pip-markdown-content" style="max-height: '+s+'em">':u()?' class="pip-markdown-list">':">")+o+"</div>"),a.find("a").attr("target","blank"),!u()&&i&&a.append('<div class="pip-gradient-block"></div>')}var l=e(r.pipText),u=e(r.pipList),d=e(r.pipLineCount);c(l(s)),o.toBoolean(r.pipRebind)&&s.$watch(l,function(e){c(e)}),s.$on("pipWindowResized",function(){c(l(s))}),a.addClass("pip-markdown")}}}])}(window.angular,window.marked,window._),function(e,t,n){"use strict";var o=e.module("pipPopover",["pipAssert"]);o.directive("pipPopover",function(){return{restrict:"EA",scope:!0,templateUrl:"popover/popover.template.html",controller:["$scope","$rootScope","$element","$timeout","$compile",function(e,o,i,s,a){function r(){m.addClass("opened"),t(".pip-popover-backdrop").focus(),e.params.timeout&&s(function(){c()},e.params.timeout)}function p(){e.params.cancelCallback&&e.params.cancelCallback(),c()}function c(){m.removeClass("opened"),s(function(){m.remove()},100)}function l(e){e.stopPropagation()}function u(){if(e.params.element){var n=t(e.params.element),o=n.offset(),i=n.width(),s=n.height(),a=t(document).width(),r=t(document).height(),p=m.find(".pip-popover");o&&p.css("max-width",a-(a-o.left)).css("max-height",r-(o.top+s)-32,0).css("left",o.left-p.width()+i/2).css("top",o.top+s+16)}}function d(){if(e.params.calcHeight!==!1){var t=m.find(".pip-popover"),n=t.find(".pip-title"),o=t.find(".pip-footer"),i=t.find(".pip-content"),s=t.height()-n.outerHeight(!0)-o.outerHeight(!0);i.css("max-height",Math.max(s,0)+"px").css("box-sizing","border-box")}}function g(){m.find(".pip-popover").find(".pip-content").css("max-height","100%"),u(),d()}var m,f;m=t(".pip-popover-backdrop"),m.on("click keydown scroll",p),m.addClass(e.params.responsive!==!1?"pip-responsive":""),s(function(){u(),e.params.template&&(f=a(e.params.template)(e),i.find(".pip-popover").append(f)),r()}),s(function(){d()},200),e.onPopoverClick=l,e=n.defaults(e,e.$parent),o.$on("pipPopoverResize",g),t(window).resize(g)}]}}),o.service("$pipPopover",["$compile","$rootScope","$timeout",function(e,o,i){function s(i){var s,r,c,l;s=t("body"),s.find("md-backdrop").length>0||(a(),r=o.$new(),c=i&&n.isObject(i)?i:{},r.params=c,r.locals=c.locals,l=e(p)(r),s.append(l))}function a(){var e=t(".pip-popover-backdrop");e.removeClass("opened"),i(function(){e.remove()},100)}function r(){o.$broadcast("pipPopoverResize")}var p;return p="<div class='pip-popover-backdrop {{ params.class }}' ng-controller='params.controller' tabindex='1'> <pip-popover pip-params='params'> </pip-popover> </div>",{show:s,hide:a,resize:r}}])}(window.angular,window.jQuery,window._),function(e){"use strict";var t=e.module("pipRoutingProgress",["ngMaterial"]);t.directive("pipRoutingProgress",function(){return{restrict:"EA",replace:!0,scope:{showProgress:"&",logoUrl:"@"},templateUrl:"progress/routing_progress.html",controller:"pipRoutingProgressController"}}),t.controller("pipRoutingProgressController",["$scope","$element","$attrs",function(e,t,n){function o(){e.logoUrl&&i.attr("src",e.logoUrl)}var i=t.children("img");o()}])}(window.angular),function(e){"use strict";var t=e.module("pipRefreshButton",["ngMaterial"]);t.directive("pipRefreshButton",["$parse",function(e){return{restrict:"EA",scope:!1,template:String()+'<md-button class="pip-refresh-button" tabindex="-1" ng-click="onClick($event)" aria-label="REFRESH"><md-icon md-svg-icon="icons:refresh"></md-icon><span class="pip-refresh-text"></span></md-button>',replace:!1,link:function(t,n,o){function i(){u.hide()}var s,a,r,p=e(o.pipText),c=e(o.pipVisible),l=e(o.pipRefresh),u=n.children(".md-button"),d=u.children(".pip-refresh-text");r=function(){a=p(t),d.text(a),u.show(),s=u.width(),u.css("margin-left","-"+s/2+"px")},t.onClick=function(){l(t)},t.$watch(c,function(e){e?r():i()}),t.$watch(p,function(e){d.text(e)})}}}])}(window.angular),function(e,t){"use strict";var n=e.module("pipToasts",["pipTranslate","ngMaterial","pipAssert"]);n.controller("pipToastController",["$scope","$mdToast","toast","pipErrorDetailsDialog",function(t,n,o,i){t.message=o.message,t.actions=o.actions,t.toast=o,0===o.actions.length?t.actionLenght=0:1===o.actions.length?t.actionLenght=o.actions[0].toString().length:t.actionLenght=null,t.onDetails=function(){n.hide(),i.show({error:t.toast.error,ok:"Ok"},e.noop,e.noop)},t.onAction=function(e){n.hide({action:e,id:o.id,message:o.message})}}]),n.service("pipToasts",["$rootScope","$mdToast","pipAssert",function(e,n,o){function i(){var e;w.length>0&&(e=w[0],w.splice(0,1),s(e))}function s(e){v=e,n.show({templateUrl:"toast/toast.html",hideDelay:e.duration||b,position:"bottom left",controller:"pipToastController",locals:{toast:v,sounds:$}}).then(function(e){v.successCallback&&v.successCallback(e),v=null,i()},function(e){v.cancelCallback&&v.cancelCallback(e),v=null,i()})}function a(e){v&&"error"!==e.type?w.push(e):s(e)}function r(e){var n=[];t.each(w,function(t){t.type&&t.type===e||n.push(t)}),w=t.cloneDeep(n)}function p(e){t.remove(w,{id:e})}function c(e){return t.find(w,{id:e})}function l(){w=t.reject(w,function(e){return"error"===e.type}),v&&"error"===v.type&&(n.cancel(),i())}function u(){h()}function d(e,t,n,i,s){o.isDef(e,"pipToasts.showNotification: message should be defined"),o.isString(e,"pipToasts.showNotification: message should be a string"),o.isArray(t||[],"pipToasts.showNotification: actions should be an array"),n&&o.isFunction(n,"showNotification: successCallback should be a function"),i&&o.isFunction(i,"showNotification: cancelCallback should be a function"),a({id:s||null,type:"notification",message:e,actions:t||["ok"],successCallback:n,cancelCallback:i,duration:C})}function g(e,t,n,i){o.isDef(e,"pipToasts.showMessage: message should be defined"),o.isString(e,"pipToasts.showMessage: message should be a string"),t&&o.isFunction(t,"pipToasts.showMessage:successCallback should be a function"),n&&o.isFunction(n,"pipToasts.showMessage: cancelCallback should be a function"),a({id:i||null,type:"message",message:e,actions:["ok"],successCallback:t,cancelCallback:n})}function m(e,t,n,i,s){o.isDef(e,"pipToasts.showError: message should be defined"),o.isString(e,"pipToasts.showError: message should be a string"),t&&o.isFunction(t,"pipToasts.showError: successCallback should be a function"),n&&o.isFunction(n,"pipToasts.showError: cancelCallback should be a function"),a({id:i||null,error:s,type:"error",message:e,actions:["ok"],successCallback:t,cancelCallback:n})}function f(){n.cancel(),w=[]}function h(e){e?(o.isString(e,"pipToasts.clearToasts: type should be a string"),r(e)):(n.cancel(),w=[])}var v,b=2e4,C=2e4,w=[],$={};return e.$on("$stateChangeSuccess",l),e.$on("pipSessionClosed",u),{showNotification:d,showMessage:g,showError:m,hideAllToasts:f,clearToasts:h,removeToastsById:p,getToastById:c}}])}(window.angular,window._),function(e){"use strict";var t=e.module("pipTagList",["pipCore"]);t.directive("pipTagList",["$parse",function(e){return{restrict:"EA",scope:{pipTags:"=",pipType:"=",pipTypeLocal:"="},templateUrl:"tags/tag_list.html",controller:["$scope","$element","$attrs","pipUtils",function(t,n,o,i){var s;s=e(o.pipTags),n.css("display","block"),t.tags=s(t),i.toBoolean(o.pipRebind)&&t.$watch(s,function(){t.tags=s(t)}),n.addClass("pip-tag-list")}]}}])}(window.angular),function(e,t){"use strict";var n=e.module("pipToggleButtons",["pipBasicControls.Templates"]);n.directive("pipToggleButtons",function(){return{restrict:"EA",scope:{ngDisabled:"&",buttons:"=pipButtons",currentButtonValue:"=ngModel",currentButton:"=?pipButtonObject",change:"&ngChange"},templateUrl:"toggle_buttons/toggle_buttons.html",controller:["$scope","$element","$attrs","$mdMedia","$timeout",function(e,n,o,i,s){var a;e.$mdMedia=i,e.class=o.class||"",(!e.buttons||t.isArray(e.buttons)&&0===e.buttons.length)&&(e.buttons=[]),a=t.indexOf(e.buttons,t.find(e.buttons,{id:e.currentButtonValue})),e.currentButtonIndex=a<0?0:a,e.currentButton=e.buttons.length>0?e.buttons[e.currentButtonIndex]:e.currentButton,e.buttonSelected=function(t){e.disabled()||(e.currentButtonIndex=t,e.currentButton=e.buttons[e.currentButtonIndex],e.currentButtonValue=e.currentButton.id||t,s(function(){e.change&&e.change()}))},e.enterSpacePress=function(t){e.buttonSelected(t.index)},e.disabled=function(){if(e.ngDisabled)return e.ngDisabled()}}],link:function(e,t){t.on("focusin",function(){t.addClass("focused-container")}).on("focusout",function(){t.removeClass("focused-container")})}}})}(window.angular,window._),function(){"use strict";var e=angular.module("pipUnsavedChanges",[]);e.directive("pipUnsavedChanges",["$window","$rootScope",function(e,t){return{restrict:"AE",scope:{unsavedChangesAvailable:"&pipUnsavedChangesAvailable",unsavedChangesMessage:"@pipUnsavedChangesMessage",afterLeave:"&pipUnsavedChangesAfterLeave"},link:function(n){e.onbeforeunload=function(){if(n.unsavedChangesAvailable())return t.$routing=!1,n.unsavedChangesMessage};var o=n.$on("$stateChangeStart",function(o){n.unsavedChangesAvailable()&&!e.confirm(n.unsavedChangesMessage)?(t.$routing=!1,o.preventDefault()):_.isFunction(n.afterLeave)&&n.afterLeave()});n.$on("$destroy",function(){e.onbeforeunload=null,o()})}}}])}();