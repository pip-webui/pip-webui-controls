!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.pip||(e.pip={})).controls=t()}}(function(){return function t(e,o,n){function i(s,a){if(!o[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=o[s]={exports:{}};e[s][0].call(p.exports,function(t){var o=e[s][1][t];return i(o?o:t)},p,p.exports,t,e,o,n)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,o){"use strict";var n=function(){function t(t,e,o,n){var i=["purple","lightgreen","green","darkred","pink","yellow","cyan"];this._$timeout=n,this._$scope=t,this.class=o.class||"",this.colors=!t.colors||_.isArray(t.colors)&&0===t.colors.length?i:t.colors,this.colorChange=t.colorChange||null,this.currentColor=t.currentColor||this.colors[0],this.currentColorIndex=this.colors.indexOf(this.currentColor),this.ngDisabled=t.ngDisabled}return t.$inject=["$scope","$element","$attrs","$timeout"],t.prototype.disabled=function(){return!this.ngDisabled||this.ngDisabled()},t.prototype.selectColor=function(t){var e=this;this.disabled()||(this.currentColorIndex=t,this.currentColor=this.colors[this.currentColorIndex],this._$timeout(function(){e._$scope.$apply()}),this.colorChange&&this.colorChange())},t.prototype.enterSpacePress=function(t){this.selectColor(t.index)},t}();o.ColorPickerController=n,function(){function t(t){"ngInject";return{restrict:"EA",scope:{ngDisabled:"&",colors:"=pipColors",currentColor:"=ngModel",colorChange:"&ngChange"},templateUrl:"color_picker/color_picker.html",controller:n,controllerAs:"vm"}}t.$inject=["$parse"],angular.module("pipColorPicker",["pipControls.Templates"]).directive("pipColorPicker",t)}()},{}],2:[function(t,e,o){!function(){"use strict";angular.module("pipControls",["pipMarkdown","pipColorPicker","pipRoutingProgress","pipPopover","pipImageSlider","pipToasts","pipControls.Translate"])}()},{}],3:[function(t,e,o){!function(){"use strict";var t=angular.module("pipControls.Translate",[]);t.filter("translate",["$injector",function(t){var e=t.has("pipTranslate")?t.get("pipTranslate"):null;return function(t){return e?e.translate(t)||t:t}}])}()},{}],4:[function(t,e,o){!function(){"use strict";var t=angular.module("pipImageSlider",["pipSliderButton","pipSliderIndicator","pipImageSlider.Service"]);t.directive("pipImageSlider",function(){return{scope:{sliderIndex:"=pipImageIndex"},controller:["$scope","$element","$attrs","$parse","$timeout","$interval","$pipImageSlider",function(t,e,o,n,i,r,s){function a(){o.pipImageIndex&&(t.sliderIndex=g)}function l(){f=r(function(){d=g+1===u.length?0:g+1,m="next",h()},k||C)}function c(){r.cancel(f)}function p(){c(),l()}var u,d,m,f,h,g=0,v=n(o.pipAnimationType)(t),C=4500,k=n(o.pipAnimationInterval)(t);e.addClass("pip-image-slider"),e.addClass("pip-animation-"+v),t.swipeStart=0,a(),i(function(){u=e.find(".pip-animation-block"),u.length>0&&$(u[0]).addClass("pip-show")}),l(),h=_.throttle(function(){s.toBlock(v,u,g,d,m),g=d,a()},700),t.nextBlock=function(){p(),d=g+1===u.length?0:g+1,m="next",h()},t.prevBlock=function(){p(),d=g-1<0?u.length-1:g-1,m="prev",h()},t.slideTo=function(t){t===g||t>u.length-1||(p(),d=t,m=t>g?"next":"prev",h())},o.id&&s.registerSlider(o.id,t),e.on("$destroy",function(){c(),s.removeSlider(o.id)})}]}})}()},{}],5:[function(t,e,o){!function(){"use strict";var t=angular.module("pipImageSlider.Service",[]);t.service("$pipImageSlider",["$timeout",function(t){function e(t,e){a[t]=e}function o(t){delete a[t]}function n(t){return a[t]}function i(e,o){e.addClass("pip-next"),t(function(){e.addClass("animated").addClass("pip-show").removeClass("pip-next"),o.addClass("animated").removeClass("pip-show")},100)}function r(e,o){t(function(){e.addClass("animated").addClass("pip-show"),o.addClass("animated").addClass("pip-next").removeClass("pip-show")},100)}function s(t,e,o,n,s){var a=$(e[o]),l=n,c=$(e[l]);"carousel"===t?($(e).removeClass("pip-next").removeClass("pip-prev").removeClass("animated"),!s||"prev"!==s&&"next"!==s?n&&n<o?r(c,a):i(c,a):"prev"===s?r(c,a):i(c,a)):(a.addClass("animated").removeClass("pip-show"),c.addClass("animated").addClass("pip-show"))}var a={};return{nextCarousel:i,prevCarousel:r,toBlock:s,registerSlider:e,removeSlider:o,getSliderScope:n}}])}()},{}],6:[function(t,e,o){!function(){"use strict";var t=angular.module("pipSliderButton",[]);t.directive("pipSliderButton",function(){return{scope:{},controller:["$scope","$element","$parse","$attrs","$pipImageSlider",function(t,e,o,n,i){var r=o(n.pipButtonType)(t),s=o(n.pipSliderId)(t);e.on("click",function(){s&&r&&i.getSliderScope(s)[r+"Block"]()})}]}})}()},{}],7:[function(t,e,o){!function(){"use strict";var t=angular.module("pipSliderIndicator",[]);t.directive("pipSliderIndicator",function(){return{scope:!1,controller:["$scope","$element","$parse","$attrs","$pipImageSlider",function(t,e,o,n,i){var r=o(n.pipSliderId)(t),s=o(n.pipSlideTo)(t);e.css("cursor","pointer"),e.on("click",function(){!r||s&&s<0||i.getSliderScope(r).slideTo(s)})}]}})}()},{}],8:[function(t,e,o){!function(){"use strict";var t=angular.module("pipMarkdown",["ngSanitize"]);t.run(["$injector",function(t){var e=t.has("pipTranslate")?t.get("pipTranslate"):null;e&&(e.setTranslations("en",{MARKDOWN_ATTACHMENTS:"Attachments:",checklist:"Checklist",documents:"Documents",pictures:"Pictures",location:"Location",time:"Time"}),e.setTranslations("ru",{MARKDOWN_ATTACHMENTS:"Вложения:",checklist:"Список",documents:"Документы",pictures:"Изображения",location:"Местонахождение",time:"Время"}))}]),t.directive("pipMarkdown",["$parse","$injector",function(t,e){var o=e.has("pipTranslate")?e.get("pipTranslate"):null;return{restrict:"EA",scope:!1,link:function(e,n,i){function r(t){var e="",n=[];return _.each(t,function(t){t.type&&"text"!==t.type&&(0===e.length&&o&&(e=o.translate("MARKDOWN_ATTACHMENTS")),n.indexOf(t.type)<0&&(n.push(t.type),e+=n.length>1?", ":" ",o&&(e+=o.translate(t.type))))}),e}function s(t){return null!=t&&(!!t&&(t=t.toString().toLowerCase(),"1"==t||"true"==t))}function a(t){var e,o,s,a,l;_.isArray(t)?(l=_.find(t,function(t){return"text"===t.type&&t.text}),e=l?l.text:r(t)):e=t,o=i.pipLineCount&&_.isNumber(p()),o=o&&e&&e.length>0,a={gfm:!0,tables:!0,breaks:!0,sanitize:!0,pedantic:!0,smartLists:!0,smartypents:!1},e=marked(e||"",a),o&&(s=1.5*p()),n.html("<div"+(o?c()?'class="pip-markdown-content pip-markdown-list" style="max-height: '+s+'em">':' class="pip-markdown-content" style="max-height: '+s+'em">':c()?' class="pip-markdown-list">':">")+e+"</div>"),n.find("a").attr("target","blank"),!c()&&o&&n.append('<div class="pip-gradient-block"></div>')}var l=t(i.pipText),c=t(i.pipList),p=t(i.pipLineCount);a(l(e)),s(i.pipRebind)&&e.$watch(l,function(t){a(t)}),e.$on("pipWindowResized",function(){a(l(e))}),n.addClass("pip-markdown")}}}])}()},{}],9:[function(t,e,o){"use strict";var n=function(){function t(t,e,o,n,i){var r=this;t=_.defaults(t,t.$parent),this._$timeout=n,this.templateUrl=t.params.templateUrl,this.template=t.params.template,this.timeout=t.params.timeout,this.element=t.params.element,this.calcH=t.params.calcHeight,this.cancelCallback=t.params.cancelCallback,this.backdropElement=$(".pip-popover-backdrop"),this.backdropElement.on("click keydown scroll",this.backdropClick),this.backdropElement.addClass(t.params.responsive!==!1?"pip-responsive":""),n(function(){r.position(),t.params.template&&(r.content=i(t.params.template)(t),o.find(".pip-popover").append(r.content)),r.init()}),n(function(){r.calcHeight()},200),e.$on("pipPopoverResize",function(){r.onResize()}),$(window).resize(function(){r.onResize()})}return t.$inject=["$scope","$rootScope","$element","$timeout","$compile"],t.prototype.init=function(){this.backdropElement.addClass("opened"),$(".pip-popover-backdrop").focus(),this.timeout&&this._$timeout(function(){this.closePopover()},this.timeout)},t.prototype.position=function(){if(this.element){var t=$(this.element),e=t.offset(),o=t.width(),n=t.height(),i=$(document).width(),r=$(document).height(),s=this.backdropElement.find(".pip-popover");e&&s.css("max-width",i-(i-e.left)).css("max-height",r-(e.top+n)-32,0).css("left",e.left-s.width()+o/2).css("top",e.top+n+16)}},t.prototype.onResize=function(){this.backdropElement.find(".pip-popover").find(".pip-content").css("max-height","100%"),this.position(),this.calcHeight()},t.prototype.calcHeight=function(){if(this.calcH!==!1){var t=this.backdropElement.find(".pip-popover"),e=t.find(".pip-title"),o=t.find(".pip-footer"),n=t.find(".pip-content"),i=t.height()-e.outerHeight(!0)-o.outerHeight(!0);n.css("max-height",Math.max(i,0)+"px").css("box-sizing","border-box")}},t.prototype.backdropClick=function(){this.cancelCallback&&this.cancelCallback(),this.closePopover()},t.prototype.closePopover=function(){var t=this;this.backdropElement.removeClass("opened"),this._$timeout(function(){t.backdropElement.remove()},100)},t.prototype.onPopoverClick=function(t){t.stopPropagation()},t}();o.PopoverController=n,function(){function t(t){"ngInject";return{restrict:"EA",scope:!0,templateUrl:"popover/popover.html",controller:n,controllerAs:"vm"}}t.$inject=["$parse"],angular.module("pipPopover",["pipPopover.Service"]).directive("pipPopover",t)}()},{}],10:[function(t,e,o){!function(){"use strict";var t=angular.module("pipPopover.Service",[]);t.service("pipPopoverService",["$compile","$rootScope","$timeout",function(t,e,o){function n(o){var n,r,a,l;n=$("body"),n.find("md-backdrop").length>0||(i(),r=e.$new(),a=o&&_.isObject(o)?o:{},r.params=a,r.locals=a.locals,l=t(s)(r),n.append(l))}function i(){var t=$(".pip-popover-backdrop");t.removeClass("opened"),o(function(){t.remove()},100)}function r(){e.$broadcast("pipPopoverResize")}var s;return s="<div class='pip-popover-backdrop {{ params.class }}' ng-controller='params.controller' tabindex='1'> <pip-popover pip-params='params'> </pip-popover> </div>",{show:n,hide:i,resize:r}}])}()},{}],11:[function(t,e,o){!function(){"use strict";var t=angular.module("pipRoutingProgress",["ngMaterial"]);t.directive("pipRoutingProgress",function(){return{restrict:"EA",replace:!0,scope:{showProgress:"&",logoUrl:"@"},templateUrl:"progress/routing_progress.html",controller:"pipRoutingProgressController"}}),t.controller("pipRoutingProgressController",["$scope","$element","$attrs",function(t,e,o){function n(){t.logoUrl&&i.attr("src",t.logoUrl)}var i=e.children("img");n()}])}()},{}],12:[function(t,e,o){!function(){"use strict";var t=angular.module("pipToasts",["ngMaterial","pipControls.Translate"]);t.controller("pipToastController",["$scope","$mdToast","toast","$injector",function(t,e,o,n){var i=n.has("pipErrorDetailsDialog")?n.get("pipErrorDetailsDialog"):null;t.message=o.message,t.actions=o.actions,t.toast=o,0===o.actions.length?t.actionLenght=0:1===o.actions.length?t.actionLenght=o.actions[0].toString().length:t.actionLenght=null,t.showDetails=null!=i,t.onDetails=function(){e.hide(),i&&i.show({error:t.toast.error,ok:"Ok"},angular.noop,angular.noop)},t.onAction=function(t){e.hide({action:t,id:o.id,message:o.message})}}]),t.service("pipToasts",["$rootScope","$mdToast",function(t,e){function o(){var t;C.length>0&&(t=C[0],C.splice(0,1),n(t))}function n(t){h=t,e.show({templateUrl:"toast/toast.html",hideDelay:t.duration||g,position:"bottom left",controller:"pipToastController",locals:{toast:h,sounds:$}}).then(function(t){h.successCallback&&h.successCallback(t),h=null,o()},function(t){h.cancelCallback&&h.cancelCallback(t),h=null,o()})}function i(t){h&&"error"!==t.type?C.push(t):n(t)}function r(t){var e=[];_.each(C,function(o){o.type&&o.type===t||e.push(o)}),C=_.cloneDeep(e)}function s(t){_.remove(C,{id:t})}function a(t){return _.find(C,{id:t})}function l(){}function c(){f()}function p(t,e,o,n,r){i({id:r||null,type:"notification",message:t,actions:e||["ok"],successCallback:o,cancelCallback:n,duration:v})}function u(t,e,o,n){i({id:n||null,type:"message",message:t,actions:["ok"],successCallback:e,cancelCallback:o})}function d(t,e,o,n,r){i({id:n||null,error:r,type:"error",message:t||"Unknown error.",actions:["ok"],successCallback:e,cancelCallback:o})}function m(){e.cancel(),C=[]}function f(t){t?r(t):(e.cancel(),C=[])}var h,g=2e4,v=2e4,C=[],$={};return t.$on("$stateChangeSuccess",l),t.$on("pipSessionClosed",c),t.$on("pipIdentityChanged",c),{showNotification:p,showMessage:u,showError:d,hideAllToasts:m,clearToasts:f,removeToastsById:s,getToastById:a}}])}()},{}],13:[function(t,e,o){!function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("color_picker/color_picker.html",'<ul class="pip-color-picker {{vm.class}}" pip-selected="vm.currentColorIndex" pip-enter-space-press="vm.enterSpacePress($event)"><li tabindex="-1" ng-repeat="color in vm.colors track by color"><md-button tabindex="-1" class="md-icon-button pip-selectable" ng-click="vm.selectColor($index)" aria-label="color" ng-disabled="vm.disabled()"><md-icon ng-style="{\'color\': color}" md-svg-icon="icons:{{ color == vm.currentColor ? \'circle\' : \'radio-off\' }}"></md-icon></md-button></li></ul>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("popover/popover.html",'<div ng-if="vm.templateUrl" class="pip-popover flex layout-column" ng-click="vm.onPopoverClick($event)" ng-include="vm.templateUrl"></div><div ng-if="vm.template" class="pip-popover" ng-click="vm.onPopoverClick($event)"></div>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("progress/routing_progress.html",'<div class="pip-routing-progress layout-column layout-align-center-center" ng-show="showProgress()"><div class="loader"><svg class="circular" viewbox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle></svg></div><img src="" height="40" width="40" class="pip-img"><md-progress-circular md-diameter="96" class="fix-ie"></md-progress-circular></div>')}])}(),function(t){try{t=angular.module("pipControls.Templates")}catch(e){t=angular.module("pipControls.Templates",[])}t.run(["$templateCache",function(t){t.put("toast/toast.html",'<md-toast class="md-action pip-toast" ng-class="{\'pip-error\': toast.type==\'error\', \'pip-column-toast\': toast.actions.length > 1 || actionLenght > 4, \'pip-no-action-toast\': actionLenght == 0}" style="height:initial; max-height: initial;"><span class="flex-var pip-text" ng-bind-html="message"></span><div class="layout-row layout-align-end-start pip-actions" ng-if="actions.length > 0 || (toast.type==\'error\' && toast.error)"><div class="flex" ng-if="toast.actions.length > 1"></div><md-button class="flex-fixed pip-toast-button" ng-if="toast.type==\'error\' && toast.error && showDetails" ng-click="onDetails()">Details</md-button><md-button class="flex-fixed pip-toast-button" ng-click="onAction(action)" ng-repeat="action in actions" aria-label="{{::action| translate}}">{{::action| translate}}</md-button></div></md-toast>')}])}()},{}]},{},[13,1,2,3,5,4,6,7,8,10,9,11,12])(13)});
//# sourceMappingURL=pip-webui-controls.min.js.map
